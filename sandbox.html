<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandbox – ScriptAbility</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="scriptability-theme">
    <div id="sandboxGate" class="sandbox-gate" hidden>
        <div class="sandbox-gate-card">
            <div class="sandbox-gate-header">
                <div class="logo-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <h1>Sandbox Access</h1>
                <p>For internal and approved testers only.</p>
            </div>
            <form id="sandboxLoginForm" class="sandbox-gate-form" novalidate>
                <div class="form-group">
                    <label for="sandboxUsername" class="sandbox-label">Username</label>
                    <input id="sandboxUsername" name="username" class="sandbox-input" type="text" autocomplete="off" autocapitalize="none" spellcheck="false" required />
                </div>
                <div class="form-group">
                    <label for="sandboxPassword" class="sandbox-label">Password</label>
                    <input id="sandboxPassword" name="password" class="sandbox-input" type="password" autocomplete="off" required />
                </div>
                <p id="sandboxLoginError" class="sandbox-gate-error" role="alert"></p>
                <button type="submit" class="btn btn-primary" id="sandboxLoginSubmit">Enter Sandbox</button>
            </form>
        </div>
    </div>

    <div id="sandboxApp" hidden>
        <header class="showroom-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-icon">
                        <i class="fas fa-pills"></i>
                    </div>
                    <div class="logo-text">
                        <h1>ScriptAbility</h1>
                        <p>Pharmacy Software Solutions</p>
                    </div>
                </div>
                <nav class="main-nav">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="#sandbox" class="nav-link" id="sandboxNavLink">Sandbox – <span id="sandboxNavProduct">SIG Normalizer</span></a>
                </nav>
                <div class="header-actions">
                    <button class="demo-btn" onclick="window.location.href='index.html'">Back to Site</button>
                    <button id="sandboxLogoutBtn" class="btn btn-secondary" type="button" hidden>Log Out</button>
                    <button class="menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </header>

        <main style="padding-top: 100px;">
            <section class="app-showcase" id="sandbox">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Sandbox</h2>
                        <p class="section-subtitle">Test our APIs instantly — no setup or configuration required.</p>
                    </div>

                    <div class="sandbox-panel">
                        <div class="sandbox-config">
                            <div class="form-group">
                                <label for="productSelect" class="sandbox-label">Product</label>
                                <select id="productSelect" class="sandbox-input">
                                    <option value="sig-normalizer">SIG Normalizer</option>
                                    <option value="ndc-analysis">NDC Analysis</option>
                                    <option value="medcast">Medcast</option>
                                    <option value="pill-identifier">Pill Identifier</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="sandbox-label">Agent Tools</label>
                                <button id="mcpToggleBtn" class="btn btn-secondary" type="button"><i class="fas fa-robot"></i> MCP Tools</button>
                            </div>
                        </div>

                        <div>
                            <div class="sandbox-grid" data-product="sig-normalizer">
                                <div class="sandbox-runner">
                                    <div class="form-group">
                                        <label for="sigInput" class="sandbox-label">Pharmacy Instruction (SIG)</label>
                                        <textarea id="sigInput" class="sandbox-textarea" rows="5" placeholder="1 tab po bid" maxlength="200"></textarea>
                                        <div class="sandbox-hint">Max 200 characters.</div>
                                    </div>
                                    <div class="sandbox-actions">
                                        <button id="runSigBtn" class="btn btn-primary"><i class="fas fa-play"></i> Run</button>
                                    </div>

                                    <div class="sandbox-output">
                                        <div class="output-header">
                                            <h3>Response</h3>
                                            <div class="output-actions">
                                                <button id="copyOutputSigBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy</button>
                                            </div>
                                        </div>
                                        <pre id="outputSig" class="sandbox-pre"></pre>
                                    </div>
                                </div>
                            </div>

                            <div class="sandbox-grid" data-product="ndc-analysis" style="display:none">
                                <div class="sandbox-runner">
                                    <div class="form-group">
                                        <label for="ndcInput" class="sandbox-label">NDC (10-digit with hyphens or 11-digit no hyphens)</label>
                                        <input id="ndcInput" class="sandbox-input" type="text" inputmode="numeric" pattern="[0-9\-]*" placeholder="e.g., 12345-6789-0 or 01234567890" autocomplete="off" />
                                    </div>
                                    <div class="sandbox-actions">
                                        <button id="runNdcBtn" class="btn btn-primary"><i class="fas fa-play"></i> Run</button>
                                    </div>

                                    <div class="sandbox-output">
                                        <div class="output-header">
                                            <h3>Response</h3>
                                            <div class="output-actions">
                                                <button id="copyOutputNdcBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy</button>
                                            </div>
                                        </div>
                                        <pre id="outputNdc" class="sandbox-pre"></pre>
                                    </div>
                                </div>
                            </div>

                        <div class="sandbox-grid" data-product="medcast" style="display:none">
                            <div class="sandbox-runner">
                                <div class="form-group">
                                    <label for="medcastFiles" class="sandbox-label">Attach files (optional)</label>
                                    <input id="medcastFiles" class="sandbox-input" type="file" multiple accept=".txt,.md,.pdf,.docx" />
                                    <div class="sandbox-hint">Up to 10 files. Allowed: .txt, .md, .pdf, .docx. Max 5MB each, 10MB total.</div>
                                </div>

                                <div class="form-group">
                                    <label for="medcastText" class="sandbox-label">Additional context (optional)</label>
                                    <textarea id="medcastText" class="sandbox-textarea" rows="5" placeholder="Paste text to include in the podcast script..."></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="medcastNdc" class="sandbox-label">NDC number (optional)</label>
                                    <input id="medcastNdc" class="sandbox-input" type="text" inputmode="numeric" pattern="[0-9\-]*" placeholder="e.g., 65862-523-01 or 65862052301" autocomplete="off" />
                                    <div class="sandbox-hint">If provided, prescription context is prepended automatically.</div>
                                </div>

                                <div class="sandbox-actions">
                                    <button id="runMedcastBtn" class="btn btn-primary"><i class="fas fa-podcast"></i> Generate Podcast</button>
                                </div>

                                <div class="sandbox-output">
                                    <div class="output-header">
                                        <h3>Status</h3>
                                    </div>
                                    <pre id="outputMedcast" class="sandbox-pre"></pre>
                                </div>
                            </div>
                        </div>

                        <div class="sandbox-grid" data-product="pill-identifier" style="display:none">
                            <div class="sandbox-runner">
                                <div class="form-group">
                                    <label for="pillName" class="sandbox-label">Medication Name</label>
                                    <input id="pillName" class="sandbox-input" type="text" placeholder="e.g., Lisinopril" autocomplete="off" />
                                </div>

                                <div class="form-group">
                                    <label for="pillNdc" class="sandbox-label">NDC Number</label>
                                    <input id="pillNdc" class="sandbox-input" type="text" inputmode="numeric" pattern="[0-9\-]*" placeholder="11-digit NDC (digits only)" autocomplete="off" />
                                    <div class="sandbox-hint">Provide the 11-digit NDC. Dashes are removed automatically.</div>
                                </div>

                                <div class="form-group">
                                    <label for="pillDescription" class="sandbox-label">Physical Description (optional)</label>
                                    <textarea id="pillDescription" class="sandbox-textarea" rows="3" placeholder="Color, shape, imprint..."></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="pillImage" class="sandbox-label">Medication Image</label>
                                    <input id="pillImage" class="sandbox-input" type="file" accept="image/jpeg,image/png,image/gif,image/webp" />
                                    <div class="sandbox-hint">Upload a clear photo of the medication. Max size 5MB. Supported: JPG, PNG, GIF, WebP.</div>
                                </div>

                                <div class="sandbox-actions">
                                    <button id="runPillBtn" class="btn btn-primary"><i class="fas fa-prescription-bottle-alt"></i> Analyze Image</button>
                                </div>

                                <div class="sandbox-output">
                                    <div class="output-header">
                                        <h3>Response</h3>
                                        <div class="output-actions">
                                            <button id="copyOutputPillBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy</button>
                                        </div>
                                    </div>
                                    <pre id="outputPill" class="sandbox-pre"></pre>
                                </div>
                            </div>
                        </div>

                        <div class="sandbox-grid mcp-panel" id="mcpPanel" style="display:none">
                            <div class="sandbox-runner">
                                <div class="mcp-status-display" style="margin-bottom: 1.5rem;">
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <strong>Connection Status:</strong>
                                        <span id="mcpStatusBadge" class="mcp-status-badge" data-status="disconnected">Disconnected</span>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="mcpEndpoint" class="sandbox-label">MCP Endpoint (HTTPS)</label>
                                    <input id="mcpEndpoint" class="sandbox-input" type="url" placeholder="https://your-mcp-host.example.com/mcp" autocomplete="off" />
                                    <div class="sandbox-hint">Must be HTTPS in production to avoid mixed content. Default for local: http://localhost:3333/mcp</div>
                                </div>

                                <div class="form-group">
                                    <div class="sandbox-hint">The ScriptAbility MCP exposes tools for AI agents and agentic workflows: <code>sig_normalize</code>, <code>ndc_analysis</code>, <code>medcast_generate_podcast</code>, <code>pill_identifier</code>.</div>
                                </div>

                                <div class="sandbox-actions" style="gap: 12px; display: flex; flex-wrap: wrap;">
                                    <button id="mcpConnectBtn" class="btn btn-primary"><i class="fas fa-plug"></i> Connect</button>
                                    <button id="mcpDisconnectBtn" class="btn btn-secondary" style="display:none;"><i class="fas fa-times-circle"></i> Disconnect</button>
                                    <button id="mcpListBtn" class="btn btn-secondary" disabled><i class="fas fa-list"></i> List Tools</button>
                                </div>

                                <div class="form-group" style="margin-top:16px;">
                                    <label for="mcpToolSelect" class="sandbox-label">Select Tool</label>
                                    <select id="mcpToolSelect" class="sandbox-input" disabled>
                                        <option value="">-- Choose a tool --</option>
                                        <option value="sig_normalize">sig_normalize - Normalize pharmacy SIG instructions</option>
                                        <option value="ndc_analysis">ndc_analysis - Look up NDC descriptor details</option>
                                        <option value="medcast_generate_podcast">medcast_generate_podcast - Generate medication podcast</option>
                                        <option value="medcast_job_status">medcast_job_status - Check Medcast job status</option>
                                        <option value="pill_identifier">pill_identifier - Analyze medication image</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="mcpArgs" class="sandbox-label">Arguments (JSON)</label>
                                    <textarea id="mcpArgs" class="sandbox-textarea" rows="6" placeholder='Select a tool to see example arguments' disabled></textarea>
                                    <div class="sandbox-hint" id="mcpArgsHint"></div>
                                </div>
                                <div class="sandbox-actions">
                                    <button id="mcpCallBtn" class="btn btn-primary" disabled><i class="fas fa-play"></i> Call Tool</button>
                                </div>

                                <div class="sandbox-output">
                                    <div class="output-header">
                                        <h3>MCP Response</h3>
                                        <div class="output-actions">
                                            <button id="copyOutputMcpBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copy</button>
                                        </div>
                                    </div>
                                    <pre id="outputMcp" class="sandbox-pre"></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sandbox-footnote">
                    <p>En-Vision America Inc.</p>
                </div>
            </div>
        </section>
    </main>

    </div>

    <script src="sandbox.js"></script>
</body>
</html>
